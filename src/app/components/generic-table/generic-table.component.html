<p-table
  #dt
  [value]="data"
  [rows]="rows"
  [paginator]="paginator"
  [selectionMode]="selectionMode"
  [(selection)]="selectedItem"
  (onRowSelect)="onRowSelect($event)"
  [dataKey]="dataKey"
  [tableStyle]="{ 'min-width': '40rem' }"
>
  <!-- 🔍 Buscador -->
  <ng-template pTemplate="caption">
    <p-iconfield iconPosition="left">
      <p-inputicon><i class="pi pi-search"></i></p-inputicon>
      <input
        pInputText
        type="text"
        (input)="onGlobalFilter($event)"
        placeholder="Global Search"
      />
    </p-iconfield>
  </ng-template>

  <!-- 🧱 Encabezado -->
  <ng-template pTemplate="header">
    <tr>
      @for (col of columns; track col) {
      <th pSortableColumn="{{ col.field }}">
        {{ col.header }}
        <p-sortIcon [field]="col.field" />
      </th>
      }
      <th>Acciones</th>
    </tr>
  </ng-template>

  <!-- 📦 Cuerpo -->
  <ng-template pTemplate="body" let-rowData>
    <tr [pSelectableRow]="rowData">
      @for (col of columns; track col) {
      <td>
        {{ getNestedValue(rowData, col.field) }}
      </td>
      }
      <!-- Botones de acción -->
      @if (acciones) {
      <td>
        <button
          pButton
          type="button"
          icon="pi pi-pencil"
          class="p-button-rounded p-button-text p-button-info"
          (click)="onEdit(rowData)"
          pTooltip="Editar"
        ></button>

        <button
          pButton
          type="button"
          icon="pi pi-eye"
          class="p-button-rounded p-button-text p-button-primary"
          (click)="onView(rowData)"
          pTooltip="Visualizar"
        ></button>
        <button
          pButton
          type="button"
          icon="pi pi-trash"
          class="p-button-rounded p-button-text p-button-danger"
          (click)="onDelete(rowData)"
          pTooltip="Eliminar"
        ></button>
      </td>
      }
    </tr>
  </ng-template>

  <!-- 🚫 Vacío -->
  <ng-template pTemplate="emptymessage">
    <tr>
      <td [attr.colspan]="columns.length">No records found.</td>
    </tr>
  </ng-template>
</p-table>
